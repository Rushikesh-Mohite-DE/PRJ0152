steps:
  DT_DIM_AW_LOAD_BUSINESSENTITY-a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5:
    operation:
      config:
        downstreamOption: false
        initialize: ON_CREATE
        lagSpecification:
          items:
            - lagPeriod: Minutes
              lagValue: 60
        orderBy:
          items:
            - colName:
                columnCounter: 3fbdfe83-4618-4bb8-8a02-9baae2f20877
                stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
        orderByDateTime:
          items:
            - {}
        partitionBy:
          items:
            - partColName:
                columnCounter: e321ab9d-a120-4178-a10a-f8559b4f6dcf
                stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
        recordVersioning: Datetime Column
        refresh_mode: AUTO
        warehouseName: COMPUTE_WH
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: TARGET
      materializationType: Dynamic Table
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3cfe15e8-19ef-4031-8aa4-3df94de81fec
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            config: {}
            dataType: STRING
            defaultValue: ""
            description: ""
            hashColumns: []
            isSurrogateKey: true
            name: DT_DIM_AW_LOAD_BUSINESSENTITY_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "{{ dimensionHistoryPk_adv() }}"
          - columnReference:
              columnCounter: e321ab9d-a120-4178-a10a-f8559b4f6dcf
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            dataType: NUMBER(38,0)
            description: Primary key for all customers, vendors, and employees.
            hashColumns: []
            hashDetails: null
            name: BUSINESSENTITYID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4b540c04-3b11-42c8-96af-874fdd4579c7
                    stepCounter: d4be5a70-f329-4ae7-9759-96fe17dec5b5
                transform: ""
          - columnReference:
              columnCounter: a1dd7cd6-0171-43b6-9429-aa417b68baa6
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            dataType: NUMBER(38,0)
            description: Primary key for all customers, vendors, and employees.
            hashColumns: []
            hashDetails: null
            name: BUSINESSENTITYID1
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 289c0915-97f9-4cdc-b5bb-0e9986b405ac
                    stepCounter: d4be5a70-f329-4ae7-9759-96fe17dec5b5
                transform: ""
          - columnReference:
              columnCounter: 7d22ef97-66b2-472c-b18c-b56a641448a1
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            dataType: VARCHAR(16777216)
            description: ROWGUIDCOL number uniquely identifying the record. Used to support a merge replication sample.
            hashColumns: []
            hashDetails: null
            name: ROWGUID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 721271fd-02f9-4715-bca1-8059a43c2937
                    stepCounter: d4be5a70-f329-4ae7-9759-96fe17dec5b5
                transform: ""
          - columnReference:
              columnCounter: 3fbdfe83-4618-4bb8-8a02-9baae2f20877
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            dataType: TIMESTAMP_NTZ(9)
            description: Date and time the record was last updated.
            hashColumns: []
            hashDetails: null
            name: MODIFIEDDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f31968ba-3379-45eb-a610-e9e2667f6050
                    stepCounter: d4be5a70-f329-4ae7-9759-96fe17dec5b5
                transform: ""
          - columnReference:
              columnCounter: 143f4f81-9a7a-4093-a804-bac9b4e6b0e2
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: HAShed
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 78dd46bf-e9ec-4d44-8383-b8a13f5dc881
                    stepCounter: d4be5a70-f329-4ae7-9759-96fe17dec5b5
                transform: ""
          - columnReference:
              columnCounter: db89a6b4-6d17-4bc1-a239-b59d639b6103
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: TWO_HASHED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 99092ea6-3e5b-413a-a86b-f4285c95e296
                    stepCounter: d4be5a70-f329-4ae7-9759-96fe17dec5b5
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 0e13dec4-054a-4b5a-8288-cb4344ec0d7c
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            isSystemStartDate: true
            name: RECORD_START_TIME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "{{ order_by_col_adv() }}"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7cf5f7b9-f5da-4b41-b819-ec2418cc1eb1
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            isSystemEndDate: true
            name: RECORD_END_TIME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: LEAD({{ order_by_col_adv()}}) OVER (PARTITION BY {{ partition_by_adv() }} ORDER BY {{ order_by_col_adv() }} asc)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b5a547e6-564d-4f37-aeaf-5ad161de7e77
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            config: {}
            dataType: NUMERIC
            defaultValue: ""
            description: ""
            hashColumns: []
            isRecordCurrent: true
            name: RECORD_CURRENT_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CASE WHEN (LEAD({{ order_by_col_adv()}}) OVER (PARTITION BY {{ partition_by_adv() }} ORDER BY {{ order_by_col_adv() }} asc)) IS NULL THEN 1 ELSE 0 END
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 107bed1c-c5be-4346-9b7f-6a74953187c1
              stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            name: RECORD_CREATED_DATE
            nullable: true
            recordCreated: true
            sourceColumnReferences:
              - columnReferences: []
                transform: FIRST_VALUE({{ order_by_col_adv()}}) OVER (PARTITION BY {{ partition_by_adv() }} ORDER BY {{ order_by_col_adv() }} asc)
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STAGE
                nodeName: STG_AW_LOAD_BUSINESSENTITY
            join:
              joinCondition: FROM {{ ref('STAGE', 'STG_AW_LOAD_BUSINESSENTITY') }} "STG_AW_LOAD_BUSINESSENTITY"
            name: DT_DIM_AW_LOAD_BUSINESSENTITY
            noLinkRefs: []
      name: DT_DIM_AW_LOAD_BUSINESSENTITY
      overrideSQL: false
      schema: ""
      sqlType: "157"
      type: sql
    stepCounter: a6da28f7-8412-4bd5-a1ce-0224dc0ccfc5
